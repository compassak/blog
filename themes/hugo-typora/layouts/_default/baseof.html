<!DOCTYPE html>
<html lang="{{ or site.Language.LanguageCode site.Language.Lang }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ if .IsHome }}{{ site.Title }}{{ else }}{{ .Title }} - {{ site.Title }}{{ end }}</title>

    <!-- CSS -->
    {{ $style := resources.Get "css/main.css" }}
    <link rel="stylesheet" href="{{ $style.RelPermalink }}">
    {{ $syntax := resources.Get "css/syntax.css" }}
    <link rel="stylesheet" href="{{ $syntax.RelPermalink }}">

    <!-- Fonts - JetBrains Mono for code -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- FontAwesome (Optional, loaded via CDN for now as per requirements to use Icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    {{ partial "header.html" . }}
    <div class="container{{ if .IsPage }} page-single{{ end }}{{ if .IsHome }} page-home{{ end }}">

        <main class="content">
            {{ block "main" . }}{{ end }}
        </main>

        <!-- Day/Night Toggle Button -->
        <div id="mode-toggle-btn" class="mode-toggle" title="Switch Theme">
            <i class="fa-solid fa-moon"></i>
        </div>
    </div>

    <!-- Theme Toggle Script -->
    <script>
        const toggleBtn = document.getElementById('mode-toggle-btn');
        const body = document.body;
        const icon = toggleBtn.querySelector('i');

        // Check local storage
        if (localStorage.getItem('theme') === 'dark') {
            body.classList.add('dark-mode');
            icon.classList.replace('fa-moon', 'fa-sun');
        }

        toggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            const isDark = body.classList.contains('dark-mode');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');

            if (isDark) {
                icon.classList.replace('fa-moon', 'fa-sun');
            } else {
                icon.classList.replace('fa-sun', 'fa-moon');
            }
        });
    </script>

    <!-- TOC Active State Script -->
    {{ $toc := resources.Get "js/toc.js" }}
    <script src="{{ $toc.RelPermalink }}"></script>
</body>

</html>